## 目录

4. 单例设计模式
5. final关键字

---

### 单例模式

**定义：**采取一定的方法保证在整个系统中，对某个类只能存在一个对象实例，并且该类只提供一个取得其对象实例的方法。（理解：避免浪费资源，一个类只创建一个对象使用，且由类内部创建，不能直接new。）

**方式：**1.饿汉式	2.懒汉式

 #### 饿汉式

1. 构造器私有化*（防止直接new）*
2. 类的内部创建对象*（因为①使得外部不能new）*
3. 向外暴露一个静态的公共方法*（因为①，外部不能创建到对象，只能用类调用类方法）*

```java
public class Person {

    private static Person person = new Person();
    private Person() {
    }
    public static Person getInstance() {
        return person;
    }
    
}
```



为什么叫饿汉：因为只要类加载，对象就会被创建，即使你没有使用到该对象。饿汉太着急了。

#### 懒汉式（使用时才创建）

1. 仍然构造器私有化
2. 定义一个static静态属性的对象变量，但为空。
3. 提供一个public的static方法，可返回一个该类对象。类中要加判断是否已经创建过了。
4. 只有当用户使用getInstance时，才创建对象进行返回。

```java
public class Person {
    
    private static Person person;
    private Person() {}
    public static Person getInstance() {
        if (person == null) {
            person = new Person();
        }
        return person;
    }
    
}
```

懒汉式只有在使用getInstance时，才创建对象。但存在线程安全问题，但可以进行完善。（why？后面学习）

饿汉式在类加载就创建了。如仅需使用该类的其他静态属性时，就浪费了。



---

### final关键字

用处：可以修饰类、方法、属性、局部变量(即方法体里的变量)

推荐写法：

- [访问限定符] [static] [final] [类型名]
- 一般final修饰的变量名推荐全大写

使用场景：

1. 当不希望类被继承时，用final修饰类*（觉得该类东西很重要）*
2. 当不希望父类的某个方法被子类重写时，用final修饰方法。
3. 当不希望类的某个属性的值被修改，可以用final修饰属性。（注意：子类仍然可以定义一个名称相同的属性，此时子类对象调用的仍然是子类的对象。**仅仅是父类中该属性的值不能被改变**）
4. 当不希望某个局部变量被修改时，可以用final修饰局部变量。

**使用细节：**

1. **final属性在定义时，必须赋初值，并且不能再修改。三种方法赋初始值。（对象被创建或类被加载时候，一定先有初始化，该初始化非系统默认 初始化）**
   
   - **定义时。public final int r = 3.14;**
   - **在构造器**
   - **在代码块**
   
2. 若是final修饰静态属性。初始化只能在定义或者静态代码块，不能在构造器中赋值。

3. 类不是final类，但含有final方法，则该方法虽然不能重写，但是可以被继承。

4. 如果一个类已经是final类，就没有必要再将方法修饰成final方法。（因为没有子类，已经不会再被子类重写）

5. **final 和 static 往往搭配使用，效率更高，底层编译器做了优化。**（理解：当一个属性被static final修饰时候，用类去调用它时，不会去加载该类。按逻辑来说会加载，但实际是因为编译时被优化了）

   【一般final值已经不会再被创建对象改变，所以建议直接搭配static，变成类变量】

6. 包装类(Integer，Double，Float。Boolean等都是final)，String也是fianl类。

7. ```java
   public int f(final int a){
          return a;
      }
   //传进去的实参可以不是final修饰的变量
   //如果实参是final变量，形参是普通变量，也可传递，即仅把final值拿到，方法体内可以任意修改。
   ```

   final可以修饰形参。（理解：把传进去的值变成final了，值不能再改变）

   【final是与目前该数据类型指针相绑定】




【注意：当final修饰一个引用类型时，指的是该地址不能改变，而不是值。如：final char[] value = {1,2,3,4}，则此时value指向的地址不能改，但是value里的值是可以随意更改的。】











